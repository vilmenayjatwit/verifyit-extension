(()=>{"use strict";({799:function(){var e=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,s){function a(e){try{c(o.next(e))}catch(e){s(e)}}function l(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,l)}c((o=o.apply(e,t||[])).next())})};document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("searchScene"),n=document.getElementById("resultsScene"),o=document.getElementById("bookmarksScene"),r=document.getElementById("resultsList"),s=document.getElementById("bookmarksList"),a=document.getElementById("backBtn"),l=document.getElementById("backFromBookmarks"),c=document.getElementById("submitBtn"),i=document.getElementById("bookmarksBtn"),d=document.getElementById("userInput"),m=document.getElementById("error"),u=document.getElementById("toast");function y(e){u.textContent=e,u.classList.add("show"),setTimeout(()=>u.classList.remove("show"),1500)}function h(){chrome.storage.local.get({bookmarks:[]},({bookmarks:e})=>{const t=e.slice(-5);if(s.innerHTML="",0===t.length){const e=document.createElement("div");return e.textContent="No bookmarks yet.",e.className="empty-message",void s.appendChild(e)}t.forEach(e=>{const t=document.createElement("div");t.className="bookmark-item";const n=document.createElement("a");n.className="result-card",n.href=e.url,n.target="_blank",n.rel="noopener noreferrer",n.textContent=e.title;const o=document.createElement("button");o.className="bookmark-remove",o.textContent="âœ–",o.addEventListener("click",()=>{chrome.storage.local.get({bookmarks:[]},({bookmarks:t})=>{const n=t.filter(t=>t.url!==e.url);chrome.storage.local.set({bookmarks:n},()=>{y("Bookmark Removed"),h()})})}),t.appendChild(n),t.appendChild(o),s.appendChild(t)})})}function p(s){return e(this,void 0,void 0,function*(){try{m.textContent="Searching for sources...",r.innerHTML="";const e=yield fetch("http://localhost:8000/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:s})}),t=yield e.json();if(!Array.isArray(t.organic_results))return void(m.textContent="No sources have been found.");const n=t.organic_results.map(e=>({title:e.title||"Untitled",snippet:e.snippet||"",url:e.link||"#",publishDate:e.publish_date||""}));chrome.runtime.sendMessage({type:"RANK",query:s,articles:n},e=>{var t;chrome.runtime.lastError?(m.textContent="Ranking failed. Showing unranked.",t=n.slice(0,3),r.innerHTML="",t.forEach(e=>{const t=document.createElement("a");t.className="result-card",t.href=e.link||"#",t.target="_blank",t.rel="noopener noreferrer",t.textContent=e.title||"Untitled",r.appendChild(t)}),k()):function(e){r.innerHTML="",e.forEach(e=>{var t;const n=document.createElement("div");n.className="result-item";const o=document.createElement("a");o.className="result-card",o.href=e.url,o.target="_blank",o.rel="noopener noreferrer",o.textContent=`${e.title} (${(null!==(t=e.score)&&void 0!==t?t:0).toFixed(2)})`;const s=document.createElement("button");s.className="bookmark-icon",s.innerText="ðŸ”–",s.addEventListener("click",()=>{chrome.storage.local.get({bookmarks:[]},({bookmarks:t})=>{t.push({title:e.title,url:e.url,publishDate:e.publishDate}),chrome.storage.local.set({bookmarks:t},()=>y("Article Saved"))})}),n.append(o,s),r.appendChild(n)}),k()}(e)})}catch(e){m.textContent="An error occurred. Please try again."}finally{t.style.display="none",n.style.display="block",o.style.display="none"}})}function k(){document.querySelectorAll("#resultsList .result-card").forEach(e=>{e.addEventListener("mousemove",t=>{const n=e.getBoundingClientRect(),o=(t.clientX-n.left)/n.width*100,r=(t.clientY-n.top)/n.height*100;e.style.setProperty("--x",`${o}%`),e.style.setProperty("--y",`${r}%`)}),e.addEventListener("mouseleave",()=>{e.style.setProperty("--x","50%"),e.style.setProperty("--y","50%")})})}a.addEventListener("click",()=>{r.innerHTML="",m.textContent="",n.style.display="none",o.style.display="none",t.style.display="block"}),i.addEventListener("click",()=>{t.style.display="none",n.style.display="none",o.style.display="block",h()}),l.addEventListener("click",()=>{o.style.display="none",n.style.display="none",t.style.display="block",m.textContent=""}),c.addEventListener("click",()=>{const e=d.value.trim();e&&p(e)});const g=new URLSearchParams(window.location.search).get("text");g&&(d.value=g,p(g));const f=(e,t)=>Math.floor(Math.random()*(t-e+1)+e);document.querySelectorAll(".particle").forEach(e=>{e.setAttribute("style",`\n        --x:${f(20,80)}; --y:${f(20,80)};\n        --duration:${f(6,20)}; --delay:${f(1,10)};\n        --alpha:${f(40,90)/100};\n        --origin-x:${Math.random()>.5?-1*f(300,800):f(300,800)}%;\n        --origin-y:${Math.random()>.5?-1*f(300,800):f(300,800)}%;\n        --size:${f(40,90)/100};\n      `)})})}})[799]()})();